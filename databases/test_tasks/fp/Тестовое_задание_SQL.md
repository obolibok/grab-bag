Задание  
В таблице ProjectActivity хранятся ProjectID проектов и дата каждого обновления проекта.  
1. Напишите SQL-запрос, вычисляющий для каждой строки, сколько дней подряд к этому моменту проект обновлялся. Первое обновление считаем как 1 день подряд.  
Пример результата запроса:  

| Date | ProjectID | DaysInRow |
| --- | --- | --- |
| 2016-10-01 | 2 | 1 |
| 2016-10-01 | 1 | 1 |
| 2016-10-02 | 1 | 2 |
| 2016-10-02 | 3 | 1 |
| 2016-10-03 | 1 | 3 |
| 2016-10-05 | 1 | 1 |


2. На основе данных таблицы напишите запрос, вычисляющий Abandoned 7 для каждой из дат в таблице ProjectActivity.  
Показатель Abandoned 7 определяет процент проектов (от общего числа обновлений за день), которые обновились в этот день, но не обновлялись в следующие 7 и более дней.  
Например:  
2016-10-01 были обновлены Проект 1 и Проект 2. Проект 1 обновился на следующий день и далее, Проект 2 не обновлялся больше ни разу.  
Abandoned 7 для 2016-10-01 равен: количество брошеных проектов / количество проектов, обновленных 2016-10-01 * 100 % = 1 / 2 * 100 % = 50 %

3. На основе данных таблицы напишите запрос, вычисляющий Retention 7 для каждой даты в таблице ProjectActivity.  
Показатель Retention 7 определяет процент проектов, которые появились ровно 7 дней назад и обновились сегодня, от общего числа проектов, созданных 7 дней назад. Датой создания считать минимальное значение даты обновления проекта.  
Например:  
2016-10-01 создано 10 проектов. Три из них обновились 2016-10-08, остальные семь — нет. Retention 7 для 2016-10-01 равен: 3 / 10 * 100 % = 30 %.  
Если 2016-10-08 обновлялись и другие проекты, созданные не 7 дней назад, они не учитываются в расчете Retention 7 для 2016-10-01. Они учитываются в Retention 7 для своей даты создания.  
Пример результата запроса:  

| Date | Retention 7 |
| --- | --- |
| 2016-10-01 | 30% |
| 2016-10-02 | 50% |
| 2016-10-03 | 45% |

